<h1 align="center">
  <picture>
    <source media="(prefers-color-scheme: dark)" srcset="./assets/icon-bright.svg" height="32">
    <img alt="Icon" src="./assets/icon-dim.svg" height="32">
  </picture> Cloud Sync
</h1>

<p align="center">
  A service built using <a href="https://hono.dev/" target="_blank">Hono</a> to save plugins, themes and fonts to the cloud.
</p>

<div align="center">
  <a href="https://github.com/nexpid/CloudSync/stargazers">
    <img alt="GitHub stars" src="https://img.shields.io/github/stars/nexpid/CloudSync?style=for-the-badge&color=D97768&labelColor=24273a&logo=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAADoSURBVHgB3ZThDcIgEEaPTlAnsBu0G5RNdAQ3cARHsCO4AXGCsoFuoBucR0RLECin9I8vuRDj9XsHbQBggIg7U7AEFCxxQkJpKFQ5AgUl8aYvvwtv+rK7iEz/+y7o4ZqqoxoTAmV6UjniNSUtLZVpru3aAI+rLW3XsxBCCzMp/bjBMqwqstyttTTaZr/PO3XWXEZ7MhMFJZ/hnkTh96houCcakM8xlFVFHAPwOXEELfBpOAIJfDqOYP5FZQqCzHwll8h/ebcBPi+4UHDv9GwjonWOwL2eTcgm0euLesiBGg+p4IhoD3/JA/V6amAVi052AAAAAElFTkSuQmCC">
  </a>
  <a href="https://github.com/nexpid/CloudSync/issues">
    <img alt="GitHub issues" src="https://img.shields.io/github/issues/nexpid/CloudSync?style=for-the-badge&color=DB707E&labelColor=24273a&logo=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAFYSURBVHgBtVaNlYIwDA5OwAiM4AaygW4gG5QNYAPYgNuAEXoj3AbcBtwGufSZaKzSFtTvvTxsyB9fm1SAABAxJ2lJLMmEN8ysMyQFrIVz4gCpGJITkWHNFepqO5IzyYHlyEEnz66OBW+Vg3M+JxRUeYnaUOUCS5JDIpjSUfnXzwyElhE2Am/7Nt/tCfMptBSwEXg5dUKX1dULopwnJKlUvNwpjFQPb4Kiu9nR+sT67wTHvROI44ufpc52jATv1ad3EdvqyopyOkC4ch/7gH0pRjv4MFyCX/5dLBllWfZDj16petYtQZr0TzdHkFeH1E1WfWXdouHFDG+CajYj3fepRitEaeVY4Yoh9yR4oaof/BfzlbftCWSi3g87fqnH9Ygrhh7TbJW/WTJslNGE2y6cJubgX5nOeSA54aVDSw7a4ePVaiAFvCcDpsPiC/8uDAfwv8oypcFT9w+9QRTccPHn0gAAAABJRU5ErkJggg==">
  </a>
  <a href="https://github.com/nexpid/CloudSync/pulls">
    <img alt="GitHub pull requests" src="https://img.shields.io/github/issues-pr/nexpid/CloudSync?style=for-the-badge&color=DA65BA&labelColor=24273a&logo=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAE8SURBVHgB7VXRjcIwDHXRDcAIGaEbXG8C2OC6wd0GHYEROsLpJoiYAJigMEG6gXFVFxzjpoAEP/Ckp9Tts50msQPwbCBiQayI3wlNTgxwK8jJY4yG6Kzg3Ue4BaQvReCNePZWcEbBdNck8OxUs71kO7DtVHCNmjjXcWfiueXR8ZgrbSs0FkpiDYk/KEZmthIax/uCcg+wPxQD5qkklQr+px1kEvV+wCekIJL4hMbp72MJPuAOZFm2p+HrGu0MHox3ghdIEIHO8K/qN3WyMuFcE8KnIS4tYYk2qokEjeETLibGbeHUHoirQZwInssKxrjj/nQaaw9aqtSua+7YTi6RwIErvDX9MG50XsxktAXznwax9vKicpaDxxgNTtxW2F9MYWzfMsNhAf1lsyf+83LBRBJHw4LNLfms4Vk4AilnOCIsG873AAAAAElFTkSuQmCC">
  </a>
  <a href="https://revenge.nexpid.xyz/cloud-sync">
    <img alt="Revenge plugin" src="https://img.shields.io/badge/revenge_plugin-install-C364D9?style=for-the-badge&labelColor=24273a&logo=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAHGSURBVEhLtZXLKwVhGIeP+yWR3EqKhVBKFFYWCNnYWUlhZSOSZGFFlCRbf4CyYiGRjYVkpZBSWMgCZeUS5T6e95v3MC7jzBzHU8+Z7/Z7v86cOd8E/GJZVhQu4jGW6nDkoGg5PqOwhUk69SPRev0GwSzM0a6TdIyxm4FK7LKbPqBwNV7gJS5hk07JXD062cV4nfYGgToT/cwcpqNs/pUajXqDQALK/f3KPvbivel9MK5R7xBqwBcT/4wUf7Sb7yxrzB8E++18SE4wVWP+IDhmSvzONeZpxD+EB/BJKrlwg+FvIFBAfpM9qebCBMbq8vCgwKQp5c4mFupyfxAcNiXcucMjPMVmjYWGxfk4i6Ho1fXzdtdqlb6cjNlc+zATD/EKXzEZq7AFMzAUgziNs9iGt1grO66Y/f7OA57hq+nZzMg3sNjpv+iRDdZo1Nt9T8jtu1ZfMAXTMBGdnGCZbJBLYxQ70O05lvu5jqu4g8c6Jt8+DuVPVoJyrDdiPgrd5pNNKjD4lnJyjnJUFJmFHmCtHOmduI1HwcEpdHKFIyhPWFiQTcIyaSTjAQZZwGJd93co1mTK2q/Idh2OHBQdwg0s0KEIEgi8AQCtDRpj/hDPAAAAAElFTkSuQmCC">
  </a>
  <a href="https://discord.gg/ddcQf3s2Uq">
    <img alt="Discord members" src="https://img.shields.io/discord/1205207689832038522?style=for-the-badge&color=9D64D9&labelColor=24273a&logo=discord&logoColor=fff">
  </a>
</div>

You can find the API documentation [here](./API_DOCS.md)

## Installation

```bash
# install without optionalDependencies
$ bun install --omit=optional
```

## Selfhosting

[![Deploy to Cloudflare](https://deploy.workers.cloudflare.com/button)](https://deploy.workers.cloudflare.com/?url=https://github.com/nexpid/CloudSync)

### Prerequsities

You need:

- [Cloudflare D1 database](https://developers.cloudflare.com/d1/)[^1]
- [Discord application](https://discord.com/developers/applications)[^2]
- Randomly generated JWT secret[^3]

Create a `.dev.vars` file based on `.dev.vars.example` with all of your secrets filled in, then run:

```bash
# publish secrets
$ bunx wrangler secret bulk .dev.vars
```

### Running

```bash
# development
$ bun run dev

# bench the size of your deployment
$ bun run dry-deploy

# deploy
$ bun run deploy
```

## Silly service

A cron schedule that runs every day at **2:00 AM UTC** which gives the bot a randomized avatar, banner and even [FPTE](https://vencord.dev/plugins/FakeProfileThemes) color theme. This is disabled by default.

To enable this, you have to create a Discord Bot user for your application. After creating it, save its token in `.dev.vars`:

```
# optional and only used for Silly cron schedule
CLIENT_TOKEN="Bot [your token here]"
```

Then run:

```bash
# install with optional dependencies
$ bun install

# publish secrets
$ bunx wrangler secret bulk .dev.vars
```

## Testing

There are some basic tests in the `test` folder, but if you're feeling brave enough, feel free to write some actual unit tests!

## License

MIT

[^1]: setup guide is [here](./HOW_TO_D1.md)

[^2]: creating a Discord bot (seperate from an application) is only required if you need a bot token (for exaple for the [silly service](#silly-service))

[^3]: run `bun run test/src/jwt.ts`
